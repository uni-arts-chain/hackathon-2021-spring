# 波卡黑客松 DeeperNetwork项目报告

## 项目背景

Deeper Network致力于构建真正的去中心化因特网和安全网关。它旨在为每个家庭带来更好的互联网体验，并成为用户通往Web 3.0 应用的入口。Deeper的愿景是将网络安全性，网络共享和区块链技术相结合，创建一个更安全，更自由，更快的去中心化网络。

## 技术构架

我们的区块链Deeper Chain构架分为两层。上层是区块链层，由Substrate为基础开发的验证节点组成，数量在几十到数百之间。下层是Deeper层，类似其他区块链项目中的Layer 2，但是设计上不完全相同，在我们设计里，上下两层是紧密相关的。其中下层的节点由Deeper Connect设备(也称作轻节点)组成，软硬件都由我们自主研发。该设备可为用户提供安全的家庭网络环境。轻节点数量可以达到上百万的级别。目前已经有上万台。

Deeper层的轻节点通过区块链层进行节点IP地址发现并建立连接；轻节点之间在可以通过分享流量来赚取代币(DPR token) 并积累信用分；轻节点的信用分积累到一定程度以后就可以通过抵押自己的信用分来参与共识并获得相应的出块奖励。在我们的共识设计中，这一部分称作Proof of Credit (PoC)。我们采取了PoC和PoS共存的形式，以确保在早期节点数目不多的情况下，网络的安全性。

在将来，用户能够以Deeper Connect为入口，轻松的使用各种去中心应用(DApp)，并与其他区块链应用进行交互。

更详细的请参考: [白皮书](https://deeper.network/whitepaper_en.pdf)

## 技术进展

从产品方面，目前Deeper Connect已经迭代好几个版本，是软硬件结合的成熟产品。其中的核心网络操作系统AtomOS为我们自主研发，可以在很低的硬件成本下，达到网速1GB的性能，同时还提供了7层网络防火墙的功能。在全球总共部署了上万个节点。其中很大一部分用户是对于网络安全、隐私以及网络加速有需求的用户。

从区块链方面，我们的测试网已经开发完毕。其中分为两大部分: 链上开发和链下交互。链上开发包括了区块链的pallet开发，比如微支付，节点发现，PoC pallets的开发。链下交互则是区块链相关的功能集成到Deeper Connect里面，这里面包括不同设备之间的微支付；设备和区块链之间的各种交互，包括节点发现，信用分委托，以及PoC挖矿等。用户可以通过设备的管理页面使用钱包，委托挖矿等功能，并且查看账户的各种信息和不同类型的交易记录。我们把整个过程自动化，尽可能的减少用户使用上的困难。用户目前只需要做的就是对密钥的备份，以及账户余额不足的时候进行充值。其他过程都可以自动进行。

在黑客松之前，我们链上部分功能基本开发完毕，因此在黑客松期间我们主要是在开发链下功能，包括设备之间的交互以及设备与区块链的交互。在我们测试过程中，也对区块链的代码进行了一定的修改和补充。具体如下：

1. （链上）对代码的优化: 包括bug的修复以及一些参数常量的调整
1. （链下）以polkadot-js api为基础，添加了各种需要的函数，包括节点发现，微支付，委托挖矿等。
1. （链下）对设备的交互和整个工作流程进行自动化: 通过区块链进行节点IP发现, 微支付流程的自动化，隧道的管理, PoC挖矿的手动和自动委托模式等等。

在我们黑客松期间，遇到的主要难点是在不同的情况下，如何处理并且不影响设备功能的正常使用。比如说用户没有绑定钱包的情况，区块链响应比较慢的情况，当用户账户上余额不足时候的情况等，会导致区块链相关的功能无法正常使用。而当这些问题解决以后，我们则需要区块链的功能能够恢复。又比如说微支付的过程中，我们也要考虑到隧道两端用户的各种情况，比如对用户不能及时支付的处理。因此各种情况下的测试是一个关键的环节，通过不断的测试来找到有所遗漏的情形。总的来说，这需要我们对异步有较好的理解。


